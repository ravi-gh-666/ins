{% extends "base.html" %}
{% block title %}Insurance Policy Scorecard{% endblock %}
{% block content %}
<div class="container">
    <div class="main-hero" style="margin-top: 120px; margin-bottom: 72px;">
        <h1 style="font-family:'Roboto','Arial',sans-serif;font-size:3.5rem;font-weight:700;line-height:1.08;letter-spacing:-.01em;margin-bottom:0.5em;">
            <span style="color:#4285f4;display:block;">Welcome to the Insurance</span>
            <span style="color:#34a853;display:block;">Portal</span>
        </h1>
        <div class="subheadline" style="font-family:'Roboto','Arial',sans-serif;font-size:1.5rem;color:#444;font-weight:400;line-height:1.4;margin-bottom:2.8rem;max-width:600px;margin-left:auto;margin-right:auto;">
            Compare, analyze, and choose the best health insurance policies for you and your family.
        </div>
        <div style="display:flex;justify-content:center;gap:18px;margin-bottom:3.2rem;">
            <a href="/scorecard" class="action-btn">Go to Scorecard</a>
            <a href="/compare" class="action-btn outline">Compare Policies</a>
        </div>
    </div>
    <div class="card bg-white rounded-lg shadow p-6 mt-8" style="font-family:'Roboto','Arial',sans-serif;font-size:1.13rem;line-height:1.6;">
        <h2 style="font-size:1.25rem;font-weight:700;color:#222;margin-bottom:1.2rem;text-align:left;">Best Health Insurance Plans in India 2025</h2>
        <table class="min-w-full border border-gray-200 rounded-lg shadow text-base" style="font-size:1.08rem;">
            <thead>
                <tr class="bg-gray-100">
                    <th class="p-4 text-left">Top Health Plans</th>
                    <th class="p-4 text-center">Insurer Rating</th>
                    <th class="p-4 text-center">Feature Rating</th>
                    <th class="p-4 text-center">Affordability</th>
                    <th class="p-4 text-center">Final Rating</th>
                </tr>
            </thead>
            <tbody>
                {% for plan in top_plans %}
                <tr class="border-b border-gray-100 top-plan-row cursor-pointer" data-insurer="{{ plan['insurer'] }}" data-policy="{{ plan['name'] }}">
                    <td class="p-4 text-left font-semibold">
                        {{ plan['name'] }}<br><span class="text-base text-gray-500">{{ plan['insurer'] }}</span>
                        {% if plan.youtube_video %}
                        <div style="background:#fff; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,0.07); width:100%; max-width:360px; aspect-ratio:16/9; display:flex; align-items:center; justify-content:center; margin-top:12px;">
                            <iframe
                                src="https://www.youtube.com/embed/{{ plan.youtube_video.split('youtu.be/')[-1] }}"
                                title="YouTube video"
                                frameborder="0"
                                allowfullscreen
                                style="width:100%; height:100%; border:none; border-radius:12px;"></iframe>
                        </div>
                        {% endif %}
                    </td>
                    <td class="text-center">{{ score_ring(plan['insurer_rating']) }}</td>
                    <td class="text-center">{{ score_ring(plan['feature_rating']) }}</td>
                    <td class="text-center">{{ score_ring(plan['affordability_rating']) }}</td>
                    <td class="text-center">{{ score_ring(plan['overall_score']) }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% for plan in top_plans %}
        {% if plan.features %}
        <div class="card bg-white rounded-lg shadow p-6 mt-8">
            <h3 style="font-size:1.15rem;font-weight:600;color:#222;margin-bottom:1.2rem;">Features for {{ plan.name }}</h3>
            {% for feature in plan.features %}
                <div class="mb-4">
                    <div class="feature-title flex items-center text-base font-semibold mb-2">
                        {{ feature.FeatureName }}
                    </div>
                    <div class="explanation text-gray-700 mb-1">{{ feature.Explanation }}</div>
                    {% if feature.youtube_video %}
                    <div style="background:#fff; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,0.07); width:100%; max-width:360px; aspect-ratio:16/9; display:flex; align-items:center; justify-content:center; margin-top:12px;">
                        <iframe
                            src="https://www.youtube.com/embed/{{ feature.youtube_video.split('youtu.be/')[-1] }}"
                            title="YouTube video"
                            frameborder="0"
                            allowfullscreen
                            style="width:100%; height:100%; border:none; border-radius:12px;"></iframe>
                    </div>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
        {% endif %}
    {% endfor %}
    <div id="scorecard-section" style="display:none; margin-top: 48px;"></div>
</div>
<!-- Move JS to static/index.js and load it externally for CSP compliance -->
<script src="{{ url_for('static', filename='index.js') }}"></script>
{% endblock %}